def make_markdown_table(array):
    """Input: Python list with rows of table as lists
               First element as header.
        Output: String to put into a .md file

    Ex Input:
        [["Name", "Age", "Height"],
         ["Jake", 20, 5'10],
         ["Mary", 21, 5'7]]
    """

    markdown = "\n" + str("| ")

    for e in array[0]:
        to_add = " " + str(e) + str(" |")
        markdown += to_add
    markdown += "\n"

    markdown += "|"
    for i in range(len(array[0])):
        markdown += str("-------------- | ")
    markdown += "\n"

    for entry in array[1:]:
        markdown += str("| ")
        for e in entry:
            to_add = str(e) + str(" | ")
            markdown += to_add
        markdown += "\n"

    return markdown + "\n"


sprc_blurry = {
    "qalign": [0.9999999999999998, 3.2118087673643227e-10],
    "pi": [-0.9999999999999998, 3.2118087673643227e-10],
    "niqe_matlab": [-0.8205128205128204, 1.346582943805166e-05],
    "niqe": [-0.9999999999999998, 3.2118087673643227e-10],
    "ilniqe": [-0.9743589743589742, 4.17535139757362e-09],
    "paq2piq": [-0.2051282051282051, 0.3674042836022003],
    "musiq-spaq": [0.9487179487179485, 2.8906278906278905e-08],
    "musiq-paq2piq": [0.9487179487179485, 2.8906278906278905e-08],
    "musiq-ava": [-0.7948717948717947, 3.1929233318122206e-05],
    "musiq": [0.4871794871794871, 0.021581605765633543],
    "laion_aes": [0.564102564102564, 0.006677354602701825],
    "entropy": [0.9999999999999998, 3.2118087673643227e-10],
    "clipiqa+_vitL14_512": [0.46153846153846145, 0.030482440656051768],
    "unique": [0.9230769230769229, 1.4164076664076665e-07],
    "tres-flive": [0.5897435897435896, 0.0042892835687974576],
    "tres": [-0.9743589743589742, 4.17535139757362e-09],
    "topiq_nr-spaq": [0.3846153846153845, 0.07631653936341436],
    "topiq_nr-flive": [0.9487179487179485, 2.8906278906278905e-08],
    "topiq_nr": [-0.769230769230769, 7.030488801322134e-05],
    "topiq_iaa_res50": [0.4102564102564102, 0.05725682817696707],
    "topiq_iaa": [0.5384615384615383, 0.010117397391702948],
    "piqe": [0.3846153846153845, 0.07631653936341436],
    "nrqm": [0.8205128205128204, 1.346582943805166e-05],
    "nima-vgg16-ava": [-0.05128205128205127, 0.8577337519090992],
    "nima-spaq": [0.9999999999999998, 3.2118087673643227e-10],
    "nima-koniq": [0.9999999999999998, 3.2118087673643227e-10],
    "nima": [0.5897435897435896, 0.0042892835687974576],
    "maniqa-pipal": [-0.25641025641025633, 0.25185761030379084],
    "maniqa-kadid": [-0.3846153846153845, 0.07631653936341436],
    "maniqa": [-0.9999999999999998, 3.2118087673643227e-10],
    "liqe": [-0.9999999999999998, 3.2118087673643227e-10],
    "dbcnn": [-0.9487179487179485, 2.8906278906278905e-08],
    "clipiqa+_rn50_512": [-0.9999999999999998, 3.2118087673643227e-10],
    "clipiqa+": [-0.9230769230769229, 1.4164076664076665e-07],
    "clipiqa": [-0.9999999999999998, 3.2118087673643227e-10],
    "brisque_matlab": [0.7435897435897434, 0.00014526497165386054],
    "arniqa-tid": [0.7948717948717947, 3.1929233318122206e-05],
    "arniqa-spaq": [0.025641025641025637, 0.9523619079608663],
    "arniqa-live": [0.4871794871794871, 0.021581605765633543],
    "arniqa-kadid": [-0.30769230769230765, 0.16348723839175228],
    "arniqa-flive": [0.9487179487179485, 2.8906278906278905e-08],
    "arniqa-csiq": [0.5128205128205127, 0.014950091061202172],
    "arniqa-clive": [-0.15384615384615383, 0.5097745711721406],
    "hyperiqa": [-0.9999999999999998, 3.2118087673643227e-10],
    "wadiqam_nr": [-0.9999999999999998, 3.2118087673643227e-10],
    "cnniqa": [-0.282051282051282, 0.2043667716671189],
}

sprc_brightness = {
    "qalign": [0.9743589743589742, 4.17535139757362e-09],
    "pi": [-0.8205128205128204, 1.346582943805166e-05],
    "niqe_matlab": [-0.5897435897435896, 0.0042892835687974576],
    "niqe": [-0.7435897435897434, 0.00014526497165386054],
    "ilniqe": [-0.6666666666666665, 0.000942590074534519],
    "paq2piq": [-0.6923076923076922, 0.0005287205721233499],
    "musiq-spaq": [0.33333333333333326, 0.12885137496248608],
    "musiq-paq2piq": [0.10256410256410255, 0.6754333995479829],
    "musiq-ava": [-0.025641025641025637, 0.9523619079608663],
    "musiq": [0.3846153846153845, 0.07631653936341436],
    "laion_aes": [0.282051282051282, 0.2043667716671189],
    "entropy": [0.9999999999999998, 3.2118087673643227e-10],
    "clipiqa+_vitL14_512": [-0.8974358974358972, 5.508252036029814e-07],
    "unique": [-0.9999999999999998, 3.2118087673643227e-10],
    "tres-flive": [-0.025641025641025637, 0.9523619079608663],
    "tres": [-0.9999999999999998, 3.2118087673643227e-10],
    "topiq_nr-spaq": [0.846153846153846, 5.202487841376731e-06],
    "topiq_nr-flive": [-0.05128205128205127, 0.8577337519090992],
    "topiq_nr": [-0.5897435897435896, 0.0042892835687974576],
    "topiq_iaa_res50": [0.564102564102564, 0.006677354602701825],
    "topiq_iaa": [0.8717948717948716, 1.8079271551493775e-06],
    "piqe": [-0.7435897435897434, 0.00014526497165386054],
    "nrqm": [0.05128205128205127, 0.8577337519090992],
    "nima-vgg16-ava": [0.5897435897435896, 0.0042892835687974576],
    "nima-spaq": [0.9743589743589742, 4.17535139757362e-09],
    "nima-koniq": [0.9487179487179485, 2.8906278906278905e-08],
    "nima": [0.9487179487179485, 2.8906278906278905e-08],
    "maniqa-pipal": [0.8974358974358972, 5.508252036029814e-07],
    "maniqa-kadid": [0.8205128205128204, 1.346582943805166e-05],
    "maniqa": [-0.9743589743589742, 4.17535139757362e-09],
    "liqe": [-0.9743589743589742, 4.17535139757362e-09],
    "cnniqa": [-0.9743589743589742, 4.17535139757362e-09],
    "dbcnn": [-0.05128205128205127, 0.8577337519090992],
    "clipiqa+_rn50_512": [-0.9487179487179485, 2.8906278906278905e-08],
    "clipiqa+": [-0.282051282051282, 0.2043667716671189],
    "clipiqa": [-0.8974358974358972, 5.508252036029814e-07],
    "brisque_matlab": [-0.769230769230769, 7.030488801322134e-05],
    "arniqa-tid": [0.9999999999999998, 3.2118087673643227e-10],
    "arniqa-spaq": [0.9487179487179485, 2.8906278906278905e-08],
    "arniqa-live": [-0.17948717948717946, 0.4353804483839206],
    "arniqa-kadid": [0.5897435897435896, 0.0042892835687974576],
    "arniqa-flive": [-0.6923076923076922, 0.0005287205721233499],
    "arniqa-csiq": [-0.564102564102564, 0.006677354602701825],
    "arniqa-clive": [0.33333333333333326, 0.12885137496248608],
    "hyperiqa": [-0.9999999999999998, 3.2118087673643227e-10],
    "wadiqam_nr": [-0.17948717948717946, 0.4353804483839206],
}

sprc_contrast = {
    "qalign": [0.9999999999999998, 3.2118087673643227e-10],
    "pi": [-0.8205128205128204, 1.346582943805166e-05],
    "niqe_matlab": [-0.9743589743589742, 4.17535139757362e-09],
    "niqe": [-0.9999999999999998, 3.2118087673643227e-10],
    "ilniqe": [-0.9999999999999998, 3.2118087673643227e-10],
    "paq2piq": [-0.769230769230769, 7.030488801322134e-05],
    "musiq-spaq": [0.4871794871794871, 0.021581605765633543],
    "musiq-paq2piq": [0.9999999999999998, 3.2118087673643227e-10],
    "musiq-ava": [-0.6666666666666665, 0.000942590074534519],
    "musiq": [0.46153846153846145, 0.030482440656051768],
    "laion_aes": [0.9999999999999998, 3.2118087673643227e-10],
    "entropy": [0.9999999999999998, 3.2118087673643227e-10],
    "clipiqa+_vitL14_512": [-0.6153846153846153, 0.002675523100870323],
    "unique": [-0.9999999999999998, 3.2118087673643227e-10],
    "tres-flive": [0.9999999999999998, 3.2118087673643227e-10],
    "tres": [0.9487179487179485, 2.8906278906278905e-08],
    "topiq_nr-spaq": [0.9999999999999998, 3.2118087673643227e-10],
    "topiq_nr-flive": [0.9999999999999998, 3.2118087673643227e-10],
    "topiq_nr": [0.15384615384615383, 0.5097745711721406],
    "topiq_iaa_res50": [0.9743589743589742, 4.17535139757362e-09],
    "topiq_iaa": [0.769230769230769, 7.030488801322134e-05],
    "piqe": [-0.23076923076923073, 0.306184939674523],
    "nrqm": [-0.30769230769230765, 0.16348723839175228],
    "nima-vgg16-ava": [0.9999999999999998, 3.2118087673643227e-10],
    "nima-spaq": [0.9999999999999998, 3.2118087673643227e-10],
    "nima-koniq": [0.9999999999999998, 3.2118087673643227e-10],
    "nima": [0.846153846153846, 5.202487841376731e-06],
    "maniqa-pipal": [-0.846153846153846, 5.202487841376731e-06],
    "maniqa-kadid": [0.9487179487179485, 2.8906278906278905e-08],
    "maniqa": [-0.9999999999999998, 3.2118087673643227e-10],
    "liqe": [-0.9999999999999998, 3.2118087673643227e-10],
    "cnniqa": [0.8717948717948716, 1.8079271551493775e-06],
    "dbcnn": [0.846153846153846, 5.202487841376731e-06],
    "clipiqa+_rn50_512": [-0.846153846153846, 5.202487841376731e-06],
    "clipiqa+": [0.846153846153846, 5.202487841376731e-06],
    "clipiqa": [-0.4102564102564102, 0.05725682817696707],
    "brisque_matlab": [-0.8974358974358972, 5.508252036029814e-07],
    "arniqa-tid": [0.9999999999999998, 3.2118087673643227e-10],
    "arniqa-spaq": [0.9999999999999998, 3.2118087673643227e-10],
    "arniqa-live": [0.8205128205128204, 1.346582943805166e-05],
    "arniqa-kadid": [-0.12820512820512817, 0.5900407829053662],
    "arniqa-flive": [0.9487179487179485, 2.8906278906278905e-08],
    "arniqa-csiq": [0.9999999999999998, 3.2118087673643227e-10],
    "arniqa-clive": [0.5128205128205127, 0.014950091061202172],
    "hyperiqa": [-0.9743589743589742, 4.17535139757362e-09],
    "wadiqam_nr": [0.30769230769230765, 0.16348723839175228],
}


sprc_blurry_sorted = {
    k: v[0]
    for k, v in sorted(
        sprc_blurry.items(), key=lambda item: abs(item[1][0]), reverse=True
    )
}

sprc_brightness_sorted = {
    k: v[0]
    for k, v in sorted(
        sprc_brightness.items(), key=lambda item: abs(item[1][0]), reverse=True
    )
}

sprc_contrast_sorted = {
    k: v[0]
    for k, v in sorted(
        sprc_contrast.items(), key=lambda item: abs(item[1][0]), reverse=True
    )
}


def common_entries(*dcts):
    if not dcts:
        return
    for i in set(dcts[0]).intersection(*dcts[1:]):
        yield (i,) + tuple(d[i] for d in dcts)


common_entries_lst = list(
    common_entries(sprc_blurry_sorted, sprc_brightness_sorted, sprc_contrast_sorted)
)

s = sorted(
    common_entries_lst,
    key=lambda item: abs(item[1]) + abs(item[2]) + abs(item[3]),
    reverse=True,
)
s.insert(
    0,
    [
        "IQA metric",
        "SPRC on blurry images",
        "SPRC on bright images",
        "SPRC on images with decreasing contrast",
    ],
)
print(make_markdown_table(s))
